import{r as n,c as N,q as b,l as v,o as w,w as h,a as R,j as e,b as r,n as y,d as U,e as F,s as L,T as q,S as C,f as A,B as E,g as M,h as f,N as D}from"./index-qzb5lCsJ.js";const Q=({room:c})=>{const[l,t]=n.useState([]),[i,o]=n.useState(""),m=N(U,"messages");n.useEffect(()=>{const s=b(m,h("room","==",c),w("createdAt"),v(5)),x=R(s,g=>{let j=[];g.forEach(d=>{j.push({...d.data(),id:d.id})}),t(j)});return()=>x()},[]);const a=async s=>{s.preventDefault(),i!==""&&(await F(m,{text:i,createdAt:L(),user:r.currentUser.displayName,uid:r.currentUser.uid,photoURL:r.currentUser.photoURL,room:c}),o(""))};return e.jsxs("div",{className:"chat-app",children:[e.jsx("div",{className:"header",children:e.jsxs("h1",{children:["Welcome to: ",c.toUpperCase()]})}),e.jsx("div",{className:"messages",children:l.map(s=>e.jsxs("div",{className:"message",children:[s.uid!==r.currentUser.uid&&e.jsx("img",{src:s.photoURL||y,alt:"Avatar",style:{width:"50px",height:"50px",borderRadius:"50%"}}),e.jsxs("span",{className:"user",children:[s.user,":"]})," ",s.text,s.uid==r.currentUser.uid&&e.jsx("img",{src:s.photoURL||y,alt:"Avatar",style:{width:"50px",height:"50px",borderRadius:"50%"}})]},s.id))}),e.jsxs("form",{onSubmit:a,className:"new-message-form",children:[e.jsx("input",{type:"text",value:i,onChange:s=>o(s.target.value),className:"new-message-input",placeholder:"Type your message here..."}),e.jsx("button",{type:"submit",className:"send-button",children:"Send"})]})]})},T=()=>{const[c,l]=n.useState([]),[t,i]=n.useState(""),o=N(U,"users");n.useEffect(()=>{(async()=>{if(t===""){l([]);return}const s=M.remove(t).toLowerCase(),[x,g]=await Promise.all([b(o,h("searchableFirstName",">=",s),h("searchableFirstName","<=",s+"")),b(o,h("searchableLastName",">=",s),h("searchableLastName","<=",s+""))]),d=(await Promise.all([f(x),f(g)])).flatMap(u=>u.docs.map(p=>({...p.data(),id:p.id}))),S=[...new Set(d.map(u=>u.id))].map(u=>d.find(p=>p.id===u));l(S)})().catch(s=>console.error("Error fetching users:",s))},[t]);const m=a=>{i(a.target.value)};return e.jsxs(e.Fragment,{children:[e.jsx(q,{label:"Search Users",value:t,onChange:m}),c.map(a=>e.jsx("div",{children:a.uid!==r.currentUser.uid&&e.jsxs(C,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx("img",{src:a.photoURL||y,alt:"users",style:{width:"60px",height:"60px",borderRadius:"50%"}}),e.jsx(A,{variant:"body1",children:a.firstName}),e.jsx(E,{children:"Add Friend"})]})},a.id))]})};function B(){return e.jsxs(e.Fragment,{children:[e.jsx(Q,{room:"1"}),e.jsx(T,{})]})}const z=()=>e.jsxs(e.Fragment,{children:[e.jsx(D,{}),e.jsx(B,{})]});export{z as default};
